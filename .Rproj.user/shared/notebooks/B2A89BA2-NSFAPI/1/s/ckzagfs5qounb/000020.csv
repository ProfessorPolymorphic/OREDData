"0",""
"0","NSFYear <- all_awards %>%"
"0","  select(estimatedTotalAmt, fundsObligatedAmt, fundProgramName,"
"0","         id, pdPIName, startDate, expDate, title, transType, coPDPI)%>%"
"0","  mutate(startDate = as.Date(startDate, format = ""%m/%d/%Y""))%>%"
"0","  mutate(expDate = as.Date(expDate, format = ""%m/%d/%Y""))%>%"
"0","  filter(expDate > as.Date(""2019-01-01"") )%>%"
"0","  mutate(periods = ceiling(as.numeric(difftime(expDate, startDate, units = ""days"")) / 365.25))%>%"
"0","  mutate(estimatedTotalAmt = as.numeric(estimatedTotalAmt))"
"0",""
"0",""
"0","NSFYear <- NSFYear %>%"
"0","  mutate(estimatedTotalAmtMillions = estimatedTotalAmt / 1e6)  # Convert to millions"
"0",""
"0","ggplot(NSFYear, aes(x = startDate, y = estimatedTotalAmt, fill = transType)) +"
"0","  geom_col() +"
"0","  scale_x_date(date_breaks = ""5 year"", date_labels = ""%Y"") +  # Display only the year part"
"0","  scale_y_continuous(labels = scales::label_number(scale = 1e-6, suffix = ""M"")) +  # Format y-axis"
"0","  labs("
"0","    x = ""Start Date"","
"0","    y = ""(Estimated) Total Award Amount (Millions)"","
"0","    fill = ""Transaction Type""  # Change legend title"
"0","  )"
